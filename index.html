<!DOCTYPE html>
<html>
  <head>
    <link rel="icon" href="data:;base64,=">

    <script type="module">
      import { client as wisp } from "/dist/wisp-client.mjs";
      console.log(wisp);

      let ws_url = location.href.replace("http", "ws");
      let ws = new wisp.WispWebSocket(ws_url + "cloudflare.com:80");
      
      ws.binaryType = "arraybuffer";
      ws.addEventListener("open", () => {
        let payload = "GET /cdn-cgi/trace HTTP/1.1\r\nHost: cloudflare.com\r\nConnection: keepalive\r\n\r\n";
        ws.send(payload);
      });
      ws.addEventListener("message", (event) => {
        let text = new TextDecoder().decode(event.data);
        console.log("message from stream 1: ", text);
      });
      ws.addEventListener("close", () => {
        console.log("stream 1 closed");
      });
    </script>
  </head>
  <body>
    <p>wisp client</p>
  </body>
</html>